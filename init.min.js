tyrano.plugin.kag.stat.change_layer_order={free:[],message:[]},$.change_layer_order={sort:function(e){const r=e.map(e=>$(`.${e}`));r.shift().after(...r)},existsSameValue:function(e){return new Set(e).size!=e.length}},tyrano.plugin.kag.tag.change_layer_order={pm:{content:"free",order:""},start:function(e){const r=e.content,a=e.order.split(","),t=Number("free"==r?this.kag.config.numCharacterLayers:this.kag.config.numMessageLayers);if(t<a.length)return console.error("[Change Layer Order] order属性にしているレイヤ数がティラノに登録されているレイヤ数を超えています"),!1;if(t>a.length)return console.error("[Change Layer Order] order属性にしているレイヤ数がティラノに登録されているレイヤ数より少ないです"),!1;if($.change_layer_order.existsSameValue(a))return console.error("[Change Layer Order] order属性に重複している要素があります。"),!1;const n=[];for(let e=0;e<a.length;e++){let t=`${a[e]}_fore`,g=`${a[e]}_back`;"message"==r&&(t="message"+t,g="message"+g),n.push(t),n.push(g)}this.kag.stat.change_layer_order[r]=n.map(e=>e),$.change_layer_order.sort(n),this.kag.ftag.nextOrder()}},tyrano.plugin.kag.tag.make_change_layer_order={start:function(e){const r=this.kag.stat.change_layer_order.free,a=this.kag.stat.change_layer_order.message;r.length===Number(this.kag.config.numCharacterLayers)&&$.change_layer_order.sort(r),a.length===Number(this.kag.config.numMessageLayers)&&$.change_layer_order.sort(a),this.kag.ftag.nextOrder()}},["change_layer_order","make_change_layer_order"].forEach(e=>{tyrano.plugin.kag.ftag.master_tag[e]=object(tyrano.plugin.kag.tag[e]),tyrano.plugin.kag.ftag.master_tag[e].kag=TYRANO.kag});